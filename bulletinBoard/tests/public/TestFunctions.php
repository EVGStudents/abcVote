<?php

/**
 *
 * abcVote (https://github.com/EVGStudents/abcVote)
 * Bulletin-Board for abcVote's e-voting applications
 *
 * TestFunctions.php: test class for Bulletin-Board's functions
 *
 * @author Sebastian Nellen <sebastian at nellen.it>
 */

use PHPUnit\Framework\TestCase;

require './src/public/functions.php';

class FunctionsTest extends TestCase
{

  public function test_verify_signature(){
    // Arrange
    $email = "alice@bfh.ch";
    $alicesCertificate = "-----BEGIN CERTIFICATE-----
MIIDBTCCAe2gAwIBAgIBAjANBgkqhkiG9w0BAQsFADAsMR0wGwYDVQQDDBRuZWxsczEtYmZoLWNsaWVudC1jYTELMAkGA1UEBhMCQ0gwHhcNMTYwMzE1MjA1NTMzWhcNMTcwMzE1MjA1NTMzWjA0MRUwEwYDVQQDDAxhbGljZUBiZmguY2gxGzAZBgkqhkiG9w0BCQEWDGFsaWNlQGJmaC5jaDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANuBphH7tMhI4YlonK4Ixwhcd9wJvJGPicYNTx/oypQc460V6SmYMcVCWFePwmRfI1mSagGcBjbEL/D6SVcFwKsl0V/mZN6GnZTiGzQ4YFeOTuDIT3YT+q6WzZ5aowFpf814wLdCdggwK5DJLbpxgwpC9+YJe4ltZBLK1pcIx/vyfToMIurT7Q22sguqy4aaoCpLpEhGwzj+iLNGFDjD9+b560tadOAtholyvk3+PoftnzhbQualKE1H2YYFHCYciWoieNGm4sXePN7VsM37Zinw4/x45fzQ16GBDfuicjADeJUn63b01yf+tomC9gi2ZQUEl1ANLvHHo/BvKc87iBsCAwEAAaMqMCgwDgYDVR0PAQH/BAQDAgeAMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMCMA0GCSqGSIb3DQEBCwUAA4IBAQBcOyxLJGHMCSmAEOQLXM3vLArBuLhiqDeLmOqmiQBOFwO099ZdSDX2twoM9tkUJwQ1FSdlHQJrAxef25n7SV7qZKFypXbzE2yjrKgYOH2Q4nlYync+pFB1Lalzxi12jo5hwmPXA6MC2clFtBEVpNg6yfR8wGCl7T/2Ihse9uoYfxmACbL65AQQm/R9dHVoLjG+x/olgRpzAJ/9Jzr0ghEci03ohOIqFOUWgYYBVG3vpjO0fghdefFX8JUaiIgQct4CovTbnafZL4FyQUas2ldXaWRltuiT2q+Qc47gWoBzribaMoVB0qSCHl9IwkHYvVhypfqWgCKEgMXtSOpRHbuW
-----END CERTIFICATE-----";
    $bobsCertificate = "-----BEGIN CERTIFICATE-----
MIIDATCCAemgAwIBAgIBAzANBgkqhkiG9w0BAQsFADAsMR0wGwYDVQQDDBRuZWxsczEtYmZoLWNsaWVudC1jYTELMAkGA1UEBhMCQ0gwHhcNMTYwMzE1MjA1NjA0WhcNMTcwMzE1MjA1NjA0WjAwMRMwEQYDVQQDDApib2JAYmZoLmNoMRkwFwYJKoZIhvcNAQkBFgpib2JAYmZoLmNoMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAw9g7DjR+W3emZd6tF+Z+rgqbPH4flMs9qga+D2skEoRRKSPX/dCXhFtqQmjyH+1SLHZucKPTXQcOnHAUqbeOxqoWYkYAHprH8K9ilHVy6cR/kvjGihqti8q2LmI4ZdR2pNmOd/l0TRP7g8rFwpRA5720U5v6QFV+WXyNQjPQelk0mLKDyQbm8Q339dofZka603IqitykqJBraXlZZv1AKnlwmeYf889uC+80sOLZlXY1Kwx68lCPEsQ5SEjRkHL+ggWTQvupsKt2LjO176+3eRq7GHvqtU9pttBd3ozSOo8512aGmCK8E5oF/D+3/YFUNQg1+B6fych+fFiW/DSmcQIDAQABoyowKDAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAFrVPLyGg0rFCWbTQN0Lo3u+w/TI4Irl5viML9e8FtA9gF0iypIb94UqI72Qfi+LW1jkm2UJt5Qgko9FNsohSqz8IVn4A9C9Jl1D1YpsLe0bSLq/ivBrK12+6yGbQSwsiDAbIdCRxeUXebCBzP0V3fICbQVoeuouEGAJFMdai8TG1/iTfHYiRXXUWj9wugAhRiQcVgwauC/yC9ZV2HEqfpOLNBMAIFSrsj7LiAAvEJY8PoQsM/lhjd8kC+C5i0CaOS5Scwx8aYnp9Ac3c/EO7F/PzylihQAWoh+BXTkmiqbOyn10xuNjLjZ3fkDPUgIwpx36iM2UVOb961mVDIN5gqg=
-----END CERTIFICATE-----";

    // Act
    $jwsSignature = "eyJhbGciOiJSUzI1NiJ9.eyJhdXRob3IiOiJhbGljZUBiZmguY2giLCJlbGVjdGlvblRpdGxlIjoiQW5vdGhlciIsImJlZ2luRGF0ZSI6IjIwMTYtMTItMjcgMDA6MDA6MDAiLCJlbmREYXRlIjoiMjAxNy0wMS0wOCAwMDowMDowMCIsImFwcFZlcnNpb24iOiIwLjE1IiwiY29lZmZpY2llbnRzIjoiMTE3NzI3MzEzNDAxMjQ5MzA5Njk1MTk5MjE5NTM3ODc0MzU2MjU4MzY5MTI1OTYzMjE4ODIzNzU3MjA2NjY0MDQzNjAzODcyMjczOTQ1MDMxNDkzNTgzMjQyNzUyMjEyMTcwNzg0MDY0MjAxMzgzMDU4NzU4MzM3ODk5MzU5NTIzNzIyMjA0MzI2NTQ0Mzg5MzU5MjY3NDM0ODY3ODE3NDI2ODQxNzEyNTU4NjkzNjg2NzM3MzU4ODkyMjU3NTgxNzE1NzQwNTQwMTg3NDU5NjA0MzcxNzAxMzYwMjcxMDA2MzA1Njk3MTQ3NzcyMjM2MzYxMjg0NjUwMDE0MzA1ODYyMjEyODM0MjMwMTI2MzU4Nzc2MjgyNjA5ODYwMzU5MzU0NDYwNDM0ODU2OTgzNDMxNzY3MzE1NjU1MDQ2NTg5OTgwMDIxMDYyNDI4MzAzOTg1NzkzNjE0NzQ1NTY2ODAxNzE3MDQ0NjM1OTQ4MTQ4NjQ4ODUxOTk1NTEwNDg5MTcwODgzODY2MzY2NzQ3ODAwNDI3MTY3OTQ0Mjc5OTcyNDUyODEzMDEwMDk3OTU0Mjg0MTg1MDg3NzgwOTc1Mjg0Mjg3MDY2NDgzOTMwODYzMTMyNjY2NDM1MjE1MDM5MjY3NjAyNTcxODI3MjcwMDc1Njk2MTU5OTc2NTk4NzUxODY2NDI3ODk2Nzk5MTIzNTAxNzQ2MTU2NDM1NjczNDI4NjQzNDI1OTcxNzU1MzMwNTk2NjUyNDUwOTY3MDI1MDg0OTQ4NzYzNjI3ODU1MTc1NDY4ODI0NTExMjU3ODA4NzgxMDE0NjY3NTYwMjI3NTU3MTk3Mjc4NTEwNTE4MzkzNzQ5OTM2NTgzNjk1NjQ3MzUyNDEyMjI1NjcyMzU5NTE0MzIzMzIwNzIxNzA0MDk1OTU2MTk1Mzk1OTA5NzYxMzE1NDEwNTk4MTg0NDc5NDQzMjkzNjE0NTE1Mzk2OTQ2ODE5MDA2ODQ0ODI2Njg5OTEzMjUwMTY4NTI1NjYzODM4ODg2OTY2MTg5MjQ4MDg2MTA1MDU4MjA2MTI2MDE4Mzc1NjA4NjM3MDUwNjc3MTI2OTk2NDc3NzQ3ODgwNDI3MjY2NzQ0OTI3MjU3NjExMzk3OTE5NjIzMzI4MzgyMjU0NDc1NTgwMTc4MDkzMjU0NDYyMjY2NzU4MTA3NjE0NzgwNTgyMDY0NzIxMzU0ODU3MjczNjc2NTMyNTEyMjk1OTI4Mjg1MzE0MDUwNjc3MjE4MzgzMjUyMTY3NjczNzgyMzk4MjM2MjQ4MDM1MzA0NzI5ODkzMTQ1NDc5NDQzNzAwMzk5NTYwOTMzMTAxMDEzNTk0NDM5MzQ4NzE1NjE3MTMzMDQ0NDc4MjgyMjk5NDc5NDA0OTc4ODE1OTkzODQ2NTgyNDE4MzIwNTI3ODE5MTQ5NzQzNTY1MDM4MTA0OTkyMDU5Mzc1MTY4MTY1NTIzMjYxMTIwMjE0NDI5OTk4MzgyMTQ5MTM2MDg2MzI3ODAwODE2MjYxNjgwODkyMDgyMTY4MTgzNzEzNDA1NDAyNzQ0NjUwNzYyNzcyNzY4ODE0MzcxMjI3MDk1MzQwNTkxMzU5NDA4MTExMDA3MjIxODQ4MDEyMDcxMDk4ODA4IiwiZWxlY3Rpb25HZW5lcmF0b3IiOiIyMTgwNjA0MTk3ODU2NDM1MTU3MTQ3NDUwMzU0NTc0MjcwNTc5NjM3MTgzODQzNDg1OTIxMTQwNDY0NTg0MjI5OTM1MDg4NzQ1NzU2MTQwMjUwNjcwOTA5ODM5MTc0MjM0NTQ3NTQ1NDY0MTM1NDYzMTEyODE2NDU0ODA4ODQzMTM1OTk4MjIwNzcyNjM1MDI0MjM5MjA2ODAxNjU2MzI4MjU3NzA5MjUwNTc2NjAyNzk3NjA5NDYyODY0OTU3NTAxNzg1NDYzMzU4NjI2OTYwMjg2MTI5MzU4MTIwMzU4MTE0MzI5NDYyMjI2NzM4MDM3MTg4NDI0NTc3NDc5NjUxNjQyMTM0Nzk0NzQ2OTIwOTc3NTQ4OTU3NTU3NjEwMzE5ODg1OTg2MTA4NTYxMDM2NDIwOCIsInZvdGluZ1RvcGljIjp7InRvcGljIjoiV2hhdCIsInBpY2siOjEsIm9wdGlvbnMiOlsiZG8iLCJZb3U_Il19LCJ2b3RlcnMiOlt7ImVtYWlsIjoiYWxpY2VAYmZoLmNoIiwic2lnbmF0dXJlIjoic3RhbmRJblNpZ25hdHVyIiwicHVibGljQ3JlZGVudGlhbCI6IjIwNjc1MTEwODg4MjI5OTc1MTM0NTM3ODM0MjYyMTMyNDI4OTIyMTA3MDg2Mzc0OTk4NDQ5NjI2MTUzMjk5MTk0MjY3ODAxMTIzNzc0MjUyOTQ5ODg2NDQ2NTYwNjQ1ODM3MzIzMzgyOTI1NjQyMzM4NTMxMTY5MTg5MTcyODUwNTQ3MTkyNjc4NDI1OTQzNjI4MjcyODU4MDgxODM4Njc5MjcwOTQzNjU3NTE3NzYxNTk4OTkxMDQzMTYwMzk5NTk2MTg2MzY3Mzc5NTIwMDk2ODEwMTc0NDU2NjA3MzE1OTE3NTI4NTI4NzM5MjI2ODEyOTA5MDUwOTQyNDIzNTA0NjY5Nzk2NTQ3Nzc2NjgzMjk3NzM0MjI5NjkwMTAxNTY4MzYwNTEzMjUwNzU2NTE4OTYwIiwiYXBwVmVyc2lvbiI6IjEuMTUifV19.o9j6K72t56gIGW_TtIeRgxjWPmQstwCQqs2zeYMA5sQEZKGZmYaLfUaSvJEbIXUfbUlEjlc_Xtm2EKsCZCkGY5sveA-JSVJhtz1zui7ToOjaTsufIj3iIxG2v8SRvcTqoiwvCTwlBzWodn7LyQd8faAVzH4QQqzwbzZgL0zDuzbi2L6E4T5SeFYILLI7mwxFkbhzfd71hALZGAZ2Ix1iIIWcOztFwCmafB_PDytI18udT1n2qgh5FrOxywoFZhlyWnmKKQ27l8RlX8KB1AggdrT-hbrGnxwW6AcxmO9ZQYMb5l3oBM4el2WLtD83fZPMyKICkcVNVhQ4wlRYrgygLQ";
    $anotherValidJwsSignature = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXUyJ9.eyJhdXRob3IiOiJhbGljZUBiZmguY2giLCJlbGVjdGlvblRpdGxlIjoiQW5vdGhlciIsImJlZ2luRGF0ZSI6IjIwMTYtMTItMjcgMDA6MDA6MDAiLCJlbmREYXRlIjoiMjAxNy0wMS0wOCAwMDowMDowMCIsImFwcFZlcnNpb24iOiIwLjE1IiwiY29lZmZpY2llbnRzIjoiMTE3NzI3MzEzNDAxMjQ5MzA5Njk1MTk5MjE5NTM3ODc0MzU2MjU4MzY5MTI1OTYzMjE4ODIzNzU3MjA2NjY0MDQzNjAzODcyMjczOTQ1MDMxNDkzNTgzMjQyNzUyMjEyMTcwNzg0MDY0MjAxMzgzMDU4NzU4MzM3ODk5MzU5NTIzNzIyMjA0MzI2NTQ0Mzg5MzU5MjY3NDM0ODY3ODE3NDI2ODQxNzEyNTU4NjkzNjg2NzM3MzU4ODkyMjU3NTgxNzE1NzQwNTQwMTg3NDU5NjA0MzcxNzAxMzYwMjcxMDA2MzA1Njk3MTQ3NzcyMjM2MzYxMjg0NjUwMDE0MzA1ODYyMjEyODM0MjMwMTI2MzU4Nzc2MjgyNjA5ODYwMzU5MzU0NDYwNDM0ODU2OTgzNDMxNzY3MzE1NjU1MDQ2NTg5OTgwMDIxMDYyNDI4MzAzOTg1NzkzNjE0NzQ1NTY2ODAxNzE3MDQ0NjM1OTQ4MTQ4NjQ4ODUxOTk1NTEwNDg5MTcwODgzODY2MzY2NzQ3ODAwNDI3MTY3OTQ0Mjc5OTcyNDUyODEzMDEwMDk3OTU0Mjg0MTg1MDg3NzgwOTc1Mjg0Mjg3MDY2NDgzOTMwODYzMTMyNjY2NDM1MjE1MDM5MjY3NjAyNTcxODI3MjcwMDc1Njk2MTU5OTc2NTk4NzUxODY2NDI3ODk2Nzk5MTIzNTAxNzQ2MTU2NDM1NjczNDI4NjQzNDI1OTcxNzU1MzMwNTk2NjUyNDUwOTY3MDI1MDg0OTQ4NzYzNjI3ODU1MTc1NDY4ODI0NTExMjU3ODA4NzgxMDE0NjY3NTYwMjI3NTU3MTk3Mjc4NTEwNTE4MzkzNzQ5OTM2NTgzNjk1NjQ3MzUyNDEyMjI1NjcyMzU5NTE0MzIzMzIwNzIxNzA0MDk1OTU2MTk1Mzk1OTA5NzYxMzE1NDEwNTk4MTg0NDc5NDQzMjkzNjE0NTE1Mzk2OTQ2ODE5MDA2ODQ0ODI2Njg5OTEzMjUwMTY4NTI1NjYzODM4ODg2OTY2MTg5MjQ4MDg2MTA1MDU4MjA2MTI2MDE4Mzc1NjA4NjM3MDUwNjc3MTI2OTk2NDc3NzQ3ODgwNDI3MjY2NzQ0OTI3MjU3NjExMzk3OTE5NjIzMzI4MzgyMjU0NDc1NTgwMTc4MDkzMjU0NDYyMjY2NzU4MTA3NjE0NzgwNTgyMDY0NzIxMzU0ODU3MjczNjc2NTMyNTEyMjk1OTI4Mjg1MzE0MDUwNjc3MjE4MzgzMjUyMTY3NjczNzgyMzk4MjM2MjQ4MDM1MzA0NzI5ODkzMTQ1NDc5NDQzNzAwMzk5NTYwOTMzMTAxMDEzNTk0NDM5MzQ4NzE1NjE3MTMzMDQ0NDc4MjgyMjk5NDc5NDA0OTc4ODE1OTkzODQ2NTgyNDE4MzIwNTI3ODE5MTQ5NzQzNTY1MDM4MTA0OTkyMDU5Mzc1MTY4MTY1NTIzMjYxMTIwMjE0NDI5OTk4MzgyMTQ5MTM2MDg2MzI3ODAwODE2MjYxNjgwODkyMDgyMTY4MTgzNzEzNDA1NDAyNzQ0NjUwNzYyNzcyNzY4ODE0MzcxMjI3MDk1MzQwNTkxMzU5NDA4MTExMDA3MjIxODQ4MDEyMDcxMDk4ODA4IiwiZWxlY3Rpb25HZW5lcmF0b3IiOiIyMTgwNjA0MTk3ODU2NDM1MTU3MTQ3NDUwMzU0NTc0MjcwNTc5NjM3MTgzODQzNDg1OTIxMTQwNDY0NTg0MjI5OTM1MDg4NzQ1NzU2MTQwMjUwNjcwOTA5ODM5MTc0MjM0NTQ3NTQ1NDY0MTM1NDYzMTEyODE2NDU0ODA4ODQzMTM1OTk4MjIwNzcyNjM1MDI0MjM5MjA2ODAxNjU2MzI4MjU3NzA5MjUwNTc2NjAyNzk3NjA5NDYyODY0OTU3NTAxNzg1NDYzMzU4NjI2OTYwMjg2MTI5MzU4MTIwMzU4MTE0MzI5NDYyMjI2NzM4MDM3MTg4NDI0NTc3NDc5NjUxNjQyMTM0Nzk0NzQ2OTIwOTc3NTQ4OTU3NTU3NjEwMzE5ODg1OTg2MTA4NTYxMDM2NDIwOCIsInZvdGluZ1RvcGljIjp7InRvcGljIjoiV2hhdCIsInBpY2siOjEsIm9wdGlvbnMiOlsiZG8iLCJZb3U_Il19LCJ2b3RlcnMiOlt7ImVtYWlsIjoiYm9iQGJmaC5jaCIsInNpZ25hdHVyZSI6InN0YW5kSW5TaWduYXR1ciIsInB1YmxpY0NyZWRlbnRpYWwiOiIyMDY3NTExMDg4ODIyOTk3NTEzNDUzNzgzNDI2MjEzMjQyODkyMjEwNzA4NjM3NDk5ODQ0OTYyNjE1MzI5OTE5NDI2NzgwMTEyMzc3NDI1Mjk0OTg4NjQ0NjU2MDY0NTgzNzMyMzM4MjkyNTY0MjMzODUzMTE2OTE4OTE3Mjg1MDU0NzE5MjY3ODQyNTk0MzYyODI3Mjg1ODA4MTgzODY3OTI3MDk0MzY1NzUxNzc2MTU5ODk5MTA0MzE2MDM5OTU5NjE4NjM2NzM3OTUyMDA5NjgxMDE3NDQ1NjYwNzMxNTkxNzUyODUyODczOTIyNjgxMjkwOTA1MDk0MjQyMzUwNDY2OTc5NjU0Nzc3NjY4MzI5NzczNDIyOTY5MDEwMTU2ODM2MDUxMzI1MDc1NjUxODk2MCIsImFwcFZlcnNpb24iOiIxLjE1In1dfQ.qGEfYWA3VmDeMLb55jyYU4kgFUci11GOUT05IgwnEWu_67I2tElHOLdHe29M40iTSq4y-dVLsYfPVjY_8bx0Hq1dv2E0d5_fro1c-CGhvdEhkf5D4Fy-oj10C59t9RRuf9WlLEgfSgVpXcHnekkhcyIzTfxN-pmsD6D6Q8tugTmfAjhxbTA6jf99uO1aAY0cBsvcvW9G-sdIG5fTKe7wZCtUdEDO1Fb4KMP_fWEo6i1wdeKgqKTxzknfkLnalR1a41kn6C8fiSU6H1H-QaY4oyag65LrYr1G3TDi3-O0p1WNQJ8hxGx8vsyL4yv1c_DHAqgXFuGFs5OuJSob7hcklQ";
    $specialCharsContainingJwsSignature = "eyJhbGciOiJSUzI1NiJ9.eyJhdXRob3IiOiJhbGljZUBiZmguY2giLCJlbGVjdGlvblRpdGxlIjoiXCJcIlwiXCJcIiTCqF5ewrV-Xl4xMcKnIiwiYmVnaW5EYXRlIjoiMjAxNi0xMi0yOCAwMDowMDowMCIsImVuZERhdGUiOiIyMDE2LTEyLTI4IDAwOjAwOjAwIiwiYXBwVmVyc2lvbiI6IjAuMTUiLCJjb2VmZmljaWVudHMiOiIxMTc3MjczMTM0MDEyNDkzMDk2OTUxOTkyMTk1Mzc4NzQzNTYyNTgzNjkxMjU5NjMyMTg4MjM3NTcyMDY2NjQwNDM2MDM4NzIyNzM5NDUwMzE0OTM1ODMyNDI3NTIyMTIxNzA3ODQwNjQyMDEzODMwNTg3NTgzMzc4OTkzNTk1MjM3MjIyMDQzMjY1NDQzODkzNTkyNjc0MzQ4Njc4MTc0MjY4NDE3MTI1NTg2OTM2ODY3MzczNTg4OTIyNTc1ODE3MTU3NDA1NDAxODc0NTk2MDQzNzE3MDEzNjAyNzEwMDYzMDU2OTcxNDc3NzIyMzYzNjEyODQ2NTAwMTQzMDU4NjIyMTI4MzQyMzAxMjYzNTg3NzYyODI2MDk4NjAzNTkzNTQ0NjA0MzQ4NTY5ODM0MzE3NjczMTU2NTUwNDY1ODk5ODAwMjEwNjI0MjgzMDM5ODU3OTM2MTQ3NDU1NjY4MDE3MTcwNDQ2MzU5NDgxNDg2NDg4NTE5OTU1MTA0ODkxNzA4ODM4NjYzNjY3NDc4MDA0MjcxNjc5NDQyNzk5NzI0NTI4MTMwMTAwOTc5NTQyODQxODUwODc3ODA5NzUyODQyODcwNjY0ODM5MzA4NjMxMzI2NjY0MzUyMTUwMzkyNjc2MDI1NzE4MjcyNzAwNzU2OTYxNTk5NzY1OTg3NTE4NjY0Mjc4OTY3OTkxMjM1MDE3NDYxNTY0MzU2NzM0Mjg2NDM0MjU5NzE3NTUzMzA1OTY2NTI0NTA5NjcwMjUwODQ5NDg3NjM2Mjc4NTUxNzU0Njg4MjQ1MTEyNTc4MDg3ODEwMTQ2Njc1NjAyMjc1NTcxOTcyNzg1MTA1MTgzOTM3NDk5MzY1ODM2OTU2NDczNTI0MTIyMjU2NzIzNTk1MTQzMjMzMjA3MjE3MDQwOTU5NTYxOTUzOTU5MDk3NjEzMTU0MTA1OTgxODQ0Nzk0NDMyOTM2MTQ1MTUzOTY5NDY4MTkwMDY4NDQ4MjY2ODk5MTMyNTAxNjg1MjU2NjM4Mzg4ODY5NjYxODkyNDgwODYxMDUwNTgyMDYxMjYwMTgzNzU2MDg2MzcwNTA2NzcxMjY5OTY0Nzc3NDc4ODA0MjcyNjY3NDQ5MjcyNTc2MTEzOTc5MTk2MjMzMjgzODIyNTQ0NzU1ODAxNzgwOTMyNTQ0NjIyNjY3NTgxMDc2MTQ3ODA1ODIwNjQ3MjEzNTQ4NTcyNzM2NzY1MzI1MTIyOTU5MjgyODUzMTQwNTA2NzcyMTgzODMyNTIxNjc2NzM3ODIzOTgyMzYyNDgwMzUzMDQ3Mjk4OTMxNDU0Nzk0NDM3MDAzOTk1NjA5MzMxMDEwMTM1OTQ0MzkzNDg3MTU2MTcxMzMwNDQ0NzgyODIyOTk0Nzk0MDQ5Nzg4MTU5OTM4NDY1ODI0MTgzMjA1Mjc4MTkxNDk3NDM1NjUwMzgxMDQ5OTIwNTkzNzUxNjgxNjU1MjMyNjExMjAyMTQ0Mjk5OTgzODIxNDkxMzYwODYzMjc4MDA4MTYyNjE2ODA4OTIwODIxNjgxODM3MTM0MDU0MDI3NDQ2NTA3NjI3NzI3Njg4MTQzNzEyMjcwOTUzNDA1OTEzNTk0MDgxMTEwMDcyMjE4NDgwMTIwNzEwOTg4MDgiLCJlbGVjdGlvbkdlbmVyYXRvciI6IjcwMzMxOTAyOTYyMjk1NjgxOTY3NzYyNDAzNDUxNzk5ODgyMDE0MjI3MzM5NTMzNDM5NDQ5MDcxOTI5NTEwODg3MTk2NTAzNzU0MTI0NTQ4NTQ4MTE0NTQ2MzA0MDcwODkzNzAxMDk1MzMzNzc4MTc5MzYwODc5NDI3ODE5MjUzMDc2NjE1NzY4ODAzNTg5Mjk5MDg0NzUyNjQ0NTgzMTQ5MTk4NTIwNDM0MzMyNzIzMjEyNjUxMjMxNzg1NTIyNDQ3MzY0ODc4MTkyNzY2NDk5NzAyNjg1NTgxNjM0ODQzNTAxMjY0ODkwMjk2MzEzODQxOTI4NTUxMjg0NjgwODY2MjU2NDUzMjg5MjY3NDcwNDg1NzAwNzQ3MTU3MDcxNDgxOTg0NzkzODgwMjIyNTk1MDIyIiwidm90aW5nVG9waWMiOnsidG9waWMiOiJBIiwicGljayI6MSwib3B0aW9ucyI6WyJCIiwiQyJdfSwidm90ZXJzIjpbeyJlbWFpbCI6ImFsaWNlQGJmaC5jaCIsInNpZ25hdHVyZSI6InN0YW5kSW5TaWduYXR1ciIsInB1YmxpY0NyZWRlbnRpYWwiOiIyMDY3NTExMDg4ODIyOTk3NTEzNDUzNzgzNDI2MjEzMjQyODkyMjEwNzA4NjM3NDk5ODQ0OTYyNjE1MzI5OTE5NDI2NzgwMTEyMzc3NDI1Mjk0OTg4NjQ0NjU2MDY0NTgzNzMyMzM4MjkyNTY0MjMzODUzMTE2OTE4OTE3Mjg1MDU0NzE5MjY3ODQyNTk0MzYyODI3Mjg1ODA4MTgzODY3OTI3MDk0MzY1NzUxNzc2MTU5ODk5MTA0MzE2MDM5OTU5NjE4NjM2NzM3OTUyMDA5NjgxMDE3NDQ1NjYwNzMxNTkxNzUyODUyODczOTIyNjgxMjkwOTA1MDk0MjQyMzUwNDY2OTc5NjU0Nzc3NjY4MzI5NzczNDIyOTY5MDEwMTU2ODM2MDUxMzI1MDc1NjUxODk2MCIsImFwcFZlcnNpb24iOiIxLjE1In1dfQ.ek1kenZ9KjJyjQJCSxcN3GA6o4Kz9ChF5TSw-656ciSKXUBQQ75Q9a2S87MWykxwPeUpAQbSA__VA6_dywUemICi1dzHZqmRh5Vv3V2bU5D8tMCSk_kPLhU-isgvcPuRR5yG_hzq6W6dz7ELK9wFbiZstzqOpmkiFnQNRP8WcQ5I279NBIZ4PMzFvfkn0Y6iY3eOCS0q1ceTioeCzhi2r644DswYacMfUvNj6UZaypWgPOFlcqGd5uzQAOtzX3NL09kYHpu4HuLeOY-XL8aKMN4zowLi6oGWgBe1pp5aZWEFTfnunC0MAR8WEFEkCdI2EFN3UVGwhnmFR-kXEe3Sgw";
    $invalidJwsSignature  = "eyJhbGciOiJSUzI1NiJ9.eyJhdXRob3IiOiJhbGljZUBiZmguY2giLCJlbGVjdGlvblRpdGxlIjoiXCJcIlwiXCJcIiTCCF5ewrV-Xl4xMcKnIiwiYmVnaW5EYXRlIjoiMjAxNi0xMi0yOCAwMDowMDowMCIsImVuZERhdGUiOiIyMDE2LTEyLTI4IDAwOjAwOjAwIiwiYXBwVmVyc2lvbiI6IjAuMTUiLCJjb2VmZmljaWVudHMiOiIxMTc3MjczMTM0MDEyNDkzMDk2OTUxOTkyMTk1Mzc4NzQzNTYyNTgzNjkxMjU5NjMyMTg4MjM3NTcyMDY2NjQwNDM2MDM4NzIyNzM5NDUwMzE0OTM1ODMyNDI3NTIyMTIxNzA3ODQwNjQyMDEzODMwNTg3NTgzMzc4OTkzNTk1MjM3MjIyMDQzMjY1NDQzODkzNTkyNjc0MzQ4Njc4MTc0MjY4NDE3MTI1NTg2OTM2ODY3MzczNTg4OTIyNTc1ODE3MTU3NDA1NDAxODc0NTk2MDQzNzE3MDEzNjAyNzEwMDYzMDU2OTcxNDc3NzIyMzYzNjEyODQ2NTAwMTQzMDU4NjIyMTI4MzQyMzAxMjYzNTg3NzYyODI2MDk4NjAzNTkzNTQ0NjA0MzQ4NTY5ODM0MzE3NjczMTU2NTUwNDY1ODk5ODAwMjEwNjI0MjgzMDM5ODU3OTM2MTQ3NDU1NjY4MDE3MTcwNDQ2MzU5NDgxNDg2NDg4NTE5OTU1MTA0ODkxNzA4ODM4NjYzNjY3NDc4MDA0MjcxNjc5NDQyNzk5NzI0NTI4MTMwMTAwOTc5NTQyODQxODUwODc3ODA5NzUyODQyODcwNjY0ODM5MzA4NjMxMzI2NjY0MzUyMTUwMzkyNjc2MDI1NzE4MjcyNzAwNzU2OTYxNTk5NzY1OTg3NTE4NjY0Mjc4OTY3OTkxMjM1MDE3NDYxNTY0MzU2NzM0Mjg2NDM0MjU5NzE3NTUzMzA1OTY2NTI0NTA5NjcwMjUwODQ5NDg3NjM2Mjc4NTUxNzU0Njg4MjQ1MTEyNTc4MDg3ODEwMTQ2Njc1NjAyMjc1NTcxOTcyNzg1MTA1MTgzOTM3NDk5MzY1ODM2OTU2NDczNTI0MTIyMjU2NzIzNTk1MTQzMjMzMjA3MjE3MDQwOTU5NTYxOTUzOTU5MDk3NjEzMTU0MTA1OTgxODQ0Nzk0NDMyOTM2MTQ1MTUzOTY5NDY4MTkwMDY4NDQ4MjY2ODk5MTMyNTAxNjg1MjU2NjM4Mzg4ODY5NjYxODkyNDgwODYxMDUwNTgyMDYxMjYwMTgzNzU2MDg2MzcwNTA2NzcxMjY5OTY0Nzc3NDc4ODA0MjcyNjY3NDQ5MjcyNTc2MTEzOTc5MTk2MjMzMjgzODIyNTQ0NzU1ODAxNzgwOTMyNTQ0NjIyNjY3NTgxMDc2MTQ3ODA1ODIwNjQ3MjEzNTQ4NTcyNzM2NzY1MzI1MTIyOTU5MjgyODUzMTQwNTA2NzcyMTgzODMyNTIxNjc2NzM3ODIzOTgyMzYyNDgwMzUzMDQ3Mjk4OTMxNDU0Nzk0NDM3MDAzOTk1NjA5MzMxMDEwMTM1OTQ0MzkzNDg3MTU2MTcxMzMwNDQ0NzgyODIyOTk0Nzk0MDQ5Nzg4MTU5OTM4NDY1ODI0MTgzMjA1Mjc4MTkxNDk3NDM1NjUwMzgxMDQ5OTIwNTkzNzUxNjgxNjU1MjMyNjExMjAyMTQ0Mjk5OTgzODIxNDkxMzYwODYzMjc4MDA4MTYyNjE2ODA4OTIwODIxNjgxODM3MTM0MDU0MDI3NDQ2NTA3NjI3NzI3Njg4MTQzNzEyMjcwOTUzNDA1OTEzNTk0MDgxMTEwMDcyMjE4NDgwMTIwNzEwOTg4MDgiLCJlbGVjdGlvbkdlbmVyYXRvciI6IjcwMzMxOTAyOTYyMjk1NjgxOTY3NzYyNDAzNDUxNzk5ODgyMDE0MjI3MzM5NTMzNDM5NDQ5MDcxOTI5NTEwODg3MTk2NTAzNzU0MTI0NTQ4NTQ4MTE0NTQ2MzA0MDcwODkzNzAxMDk1MzMzNzc4MTc5MzYwODc5NDI3ODE5MjUzMDc2NjE1NzY4ODAzNTg5Mjk5MDg0NzUyNjQ0NTgzMTQ5MTk4NTIwNDM0MzMyNzIzMjEyNjUxMjMxNzg1NTIyNDQ3MzY0ODc4MTkyNzY2NDk5NzAyNjg1NTgxNjM0ODQzNTAxMjY0ODkwMjk2MzEzODQxOTI4NTUxMjg0NjgwODY2MjU2NDUzMjg5MjY3NDcwNDg1NzAwNzQ3MTU3MDcxNDgxOTg0NzkzODgwMjIyNTk1MDIyIiwidm90aW5nVG9waWMiOnsidG9waWMiOiJBIiwicGljayI6MSwib3B0aW9ucyI6WyJCIiwiQyJdfSwidm90ZXJzIjpbeyJlbWFpbCI6ImFsaWNlQGJmaC5jaCIsInNpZ25hdHVyZSI6InN0YW5kSW5TaWduYXR1ciIsInB1YmxpY0NyZWRlbnRpYWwiOiIyMDY3NTExMDg4ODIyOTk3NTEzNDUzNzgzNDI2MjEzMjQyODkyMjEwNzA4NjM3NDk5ODQ0OTYyNjE1MzI5OTE5NDI2NzgwMTEyMzc3NDI1Mjk0OTg4NjQ0NjU2MDY0NTgzNzMyMzM4MjkyNTY0MjMzODUzMTE2OTE4OTE3Mjg1MDU0NzE5MjY3ODQyNTk0MzYyODI3Mjg1ODA4MTgzODY3OTI3MDk0MzY1NzUxNzc2MTU5ODk5MTA0MzE2MDM5OTU5NjE4NjM2NzM3OTUyMDA5NjgxMDE3NDQ1NjYwNzMxNTkxNzUyODUyODczOTIyNjgxMjkwOTA1MDk0MjQyMzUwNDY2OTc5NjU0Nzc3NjY4MzI5NzczNDIyOTY5MDEwMTU2ODM2MDUxMzI1MDc1NjUxODk2MCIsImFwcFZlcnNpb24iOiIxLjE1In1dfQ.ek1kenZ9KjJyjQJCSxcN3GA6o4Kz9ChF5TSw-656ciSKXUBQQ75Q9a2S87MWykxwPeUpAQbSA__VA6_dywUemICi1dzHZqmRh5Vv3V2bU5D8tMCSk_kPLhU-isgvcPuRR5yG_hzq6W6dz7ELK9wFbiZstzqOpmkiFnQNRP8WcQ5I279NBIZ4PMzFvfkn0Y6iY3eOCS0q1ceTioeCzhi2r644DswYacMfUvNj6UZaypWgPOFlcqGd5uzQAOtzX3NL09kYHpu4HuLeOY-XL8aKMN4zowLi6oGWgBe1pp5aZWEFTfnunC0MAR8WEFEkCdI2EFN3UVGwhnmFR-kXEe3Sgw";

    // Assert
    $this->assertTrue(verify_signature($email, $alicesCertificate, $jwsSignature));
    $this->assertTrue(verify_signature($email, $alicesCertificate, $anotherValidJwsSignature));
    $this->assertTrue(verify_signature($email, $alicesCertificate, $specialCharsContainingJwsSignature));

    $this->assertFalse(verify_signature($email, $bobsCertificate, $jwsSignature));
    $this->assertFalse(verify_signature($email, $bobsCertificate, $anotherValidJwsSignature));
    $this->assertFalse(verify_signature($email, $bobsCertificate, $specialCharsContainingJwsSignature));

    $this->assertFalse(verify_signature($email, $alicesCertificate, $invalidJwsSignature));
  }

  public function test_get_jwsPayload() {
    // Arrange
    $jwsSignature = "eyJhbGciOiJSUzI1NiJ9.eyJhdXRob3IiOiJhbGljZUBiZmguY2giLCJlbGVjdGlvblRpdGxlIjoiQW5vdGhlciTDpCIsImJlZ2luRGF0ZSI6IjIwMTYtMTItMjcgMDA6MDA6MDAiLCJlbmREYXRlIjoiMjAxNy0wMS0wOCAwMDowMDowMCIsImFwcFZlcnNpb24iOiIwLjE1IiwiY29lZmZpY2llbnRzIjoiMTE3NzI3MzEzNDAxMjQ5MzA5Njk1MTk5MjE5NTM3ODc0MzU2MjU4MzY5MTI1OTYzMjE4ODIzNzU3MjA2NjY0MDQzNjAzODcyMjczOTQ1MDMxNDkzNTgzMjQyNzUyMjEyMTcwNzg0MDY0MjAxMzgzMDU4NzU4MzM3ODk5MzU5NTIzNzIyMjA0MzI2NTQ0Mzg5MzU5MjY3NDM0ODY3ODE3NDI2ODQxNzEyNTU4NjkzNjg2NzM3MzU4ODkyMjU3NTgxNzE1NzQwNTQwMTg3NDU5NjA0MzcxNzAxMzYwMjcxMDA2MzA1Njk3MTQ3NzcyMjM2MzYxMjg0NjUwMDE0MzA1ODYyMjEyODM0MjMwMTI2MzU4Nzc2MjgyNjA5ODYwMzU5MzU0NDYwNDM0ODU2OTgzNDMxNzY3MzE1NjU1MDQ2NTg5OTgwMDIxMDYyNDI4MzAzOTg1NzkzNjE0NzQ1NTY2ODAxNzE3MDQ0NjM1OTQ4MTQ4NjQ4ODUxOTk1NTEwNDg5MTcwODgzODY2MzY2NzQ3ODAwNDI3MTY3OTQ0Mjc5OTcyNDUyODEzMDEwMDk3OTU0Mjg0MTg1MDg3NzgwOTc1Mjg0Mjg3MDY2NDgzOTMwODYzMTMyNjY2NDM1MjE1MDM5MjY3NjAyNTcxODI3MjcwMDc1Njk2MTU5OTc2NTk4NzUxODY2NDI3ODk2Nzk5MTIzNTAxNzQ2MTU2NDM1NjczNDI4NjQzNDI1OTcxNzU1MzMwNTk2NjUyNDUwOTY3MDI1MDg0OTQ4NzYzNjI3ODU1MTc1NDY4ODI0NTExMjU3ODA4NzgxMDE0NjY3NTYwMjI3NTU3MTk3Mjc4NTEwNTE4MzkzNzQ5OTM2NTgzNjk1NjQ3MzUyNDEyMjI1NjcyMzU5NTE0MzIzMzIwNzIxNzA0MDk1OTU2MTk1Mzk1OTA5NzYxMzE1NDEwNTk4MTg0NDc5NDQzMjkzNjE0NTE1Mzk2OTQ2ODE5MDA2ODQ0ODI2Njg5OTEzMjUwMTY4NTI1NjYzODM4ODg2OTY2MTg5MjQ4MDg2MTA1MDU4MjA2MTI2MDE4Mzc1NjA4NjM3MDUwNjc3MTI2OTk2NDc3NzQ3ODgwNDI3MjY2NzQ0OTI3MjU3NjExMzk3OTE5NjIzMzI4MzgyMjU0NDc1NTgwMTc4MDkzMjU0NDYyMjY2NzU4MTA3NjE0NzgwNTgyMDY0NzIxMzU0ODU3MjczNjc2NTMyNTEyMjk1OTI4Mjg1MzE0MDUwNjc3MjE4MzgzMjUyMTY3NjczNzgyMzk4MjM2MjQ4MDM1MzA0NzI5ODkzMTQ1NDc5NDQzNzAwMzk5NTYwOTMzMTAxMDEzNTk0NDM5MzQ4NzE1NjE3MTMzMDQ0NDc4MjgyMjk5NDc5NDA0OTc4ODE1OTkzODQ2NTgyNDE4MzIwNTI3ODE5MTQ5NzQzNTY1MDM4MTA0OTkyMDU5Mzc1MTY4MTY1NTIzMjYxMTIwMjE0NDI5OTk4MzgyMTQ5MTM2MDg2MzI3ODAwODE2MjYxNjgwODkyMDgyMTY4MTgzNzEzNDA1NDAyNzQ0NjUwNzYyNzcyNzY4ODE0MzcxMjI3MDk1MzQwNTkxMzU5NDA4MTExMDA3MjIxODQ4MDEyMDcxMDk4ODA4IiwiZWxlY3Rpb25HZW5lcmF0b3IiOiIyMTgwNjA0MTk3ODU2NDM1MTU3MTQ3NDUwMzU0NTc0MjcwNTc5NjM3MTgzODQzNDg1OTIxMTQwNDY0NTg0MjI5OTM1MDg4NzQ1NzU2MTQwMjUwNjcwOTA5ODM5MTc0MjM0NTQ3NTQ1NDY0MTM1NDYzMTEyODE2NDU0ODA4ODQzMTM1OTk4MjIwNzcyNjM1MDI0MjM5MjA2ODAxNjU2MzI4MjU3NzA5MjUwNTc2NjAyNzk3NjA5NDYyODY0OTU3NTAxNzg1NDYzMzU4NjI2OTYwMjg2MTI5MzU4MTIwMzU4MTE0MzI5NDYyMjI2NzM4MDM3MTg4NDI0NTc3NDc5NjUxNjQyMTM0Nzk0NzQ2OTIwOTc3NTQ4OTU3NTU3NjEwMzE5ODg1OTg2MTA4NTYxMDM2NDIwOCIsInZvdGluZ1RvcGljIjp7InRvcGljIjoiV2hhdCIsInBpY2siOjEsIm9wdGlvbnMiOlsiZG8iLCJZb3U_Il19LCJ2b3RlcnMiOlt7ImVtYWlsIjoiYWxpY2VAYmZoLmNoIiwic2lnbmF0dXJlIjoic3RhbmRJblNpZ25hdHVyIiwicHVibGljQ3JlZGVudGlhbCI6IjIwNjc1MTEwODg4MjI5OTc1MTM0NTM3ODM0MjYyMTMyNDI4OTIyMTA3MDg2Mzc0OTk4NDQ5NjI2MTUzMjk5MTk0MjY3ODAxMTIzNzc0MjUyOTQ5ODg2NDQ2NTYwNjQ1ODM3MzIzMzgyOTI1NjQyMzM4NTMxMTY5MTg5MTcyODUwNTQ3MTkyNjc4NDI1OTQzNjI4MjcyODU4MDgxODM4Njc5MjcwOTQzNjU3NTE3NzYxNTk4OTkxMDQzMTYwMzk5NTk2MTg2MzY3Mzc5NTIwMDk2ODEwMTc0NDU2NjA3MzE1OTE3NTI4NTI4NzM5MjI2ODEyOTA5MDUwOTQyNDIzNTA0NjY5Nzk2NTQ3Nzc2NjgzMjk3NzM0MjI5NjkwMTAxNTY4MzYwNTEzMjUwNzU2NTE4OTYwIiwiYXBwVmVyc2lvbiI6IjEuMTUifV19.vQYS0rT_MBU1pNAdMt8F4CCdjWw5B5QioCyuk6XE4hNcGtL3lbAV_9owiXmTEX3faM5_xxTzbVEAk9L5BIjTl16nIbGE4s_A7Ew9MDTgwiqBr7WiCq1ZZ1Ga2GRc1mkW5FgKkykr2tkvub4E4wVEGK6mwTIPrqQLNaofHopPB0sjR132afIn40bI1X8VzJUoqCOavNraCIYXciVRsK_bBpkqfLiHTC3kwj205uCcZx6Ztasr02D3K-G3Neyc9wLZ3Ci_ns37dfc29txH4qnnPkPRENqKOA6aErEHtEw8j5HoqCa_qBkAp0B9e8svWXs-LqjZxXdDBUWVw-sFlRpdAw";
    $jwsPayload = array(
      "author" => "alice@bfh.ch",
      "electionTitle" => "Another\$Ã¤",
      "beginDate" => "2016-12-27 00:00:00",
      "endDate" => "2017-01-08 00:00:00",
      "appVersion" => "0.15",
      "coefficients" => "117727313401249309695199219537874356258369125963218823757206664043603872273945031493583242752212170784064201383058758337899359523722204326544389359267434867817426841712558693686737358892257581715740540187459604371701360271006305697147772236361284650014305862212834230126358776282609860359354460434856983431767315655046589980021062428303985793614745566801717044635948148648851995510489170883866366747800427167944279972452813010097954284185087780975284287066483930863132666435215039267602571827270075696159976598751866427896799123501746156435673428643425971755330596652450967025084948763627855175468824511257808781014667560227557197278510518393749936583695647352412225672359514323320721704095956195395909761315410598184479443293614515396946819006844826689913250168525663838886966189248086105058206126018375608637050677126996477747880427266744927257611397919623328382254475580178093254462266758107614780582064721354857273676532512295928285314050677218383252167673782398236248035304729893145479443700399560933101013594439348715617133044478282299479404978815993846582418320527819149743565038104992059375168165523261120214429998382149136086327800816261680892082168183713405402744650762772768814371227095340591359408111007221848012071098808",
      "electionGenerator" => "21806041978564351571474503545742705796371838434859211404645842299350887457561402506709098391742345475454641354631128164548088431359982207726350242392068016563282577092505766027976094628649575017854633586269602861293581203581143294622267380371884245774796516421347947469209775489575576103198859861085610364208",
      "votingTopic" => array(
        "topic" => "What",
        "pick" => 1,
        "options" => ["do", "You?"]
      ),
      "voters" => array(
        [
        "email" => "alice@bfh.ch",
        "signature" => "standInSignatur",
        "publicCredential" => "20675110888229975134537834262132428922107086374998449626153299194267801123774252949886446560645837323382925642338531169189172850547192678425943628272858081838679270943657517761598991043160399596186367379520096810174456607315917528528739226812909050942423504669796547776683297734229690101568360513250756518960",
        "appVersion" => "1.15"
        ]
      )
    );

    // Act
    $temperedJwsPayload = array(
          "author" => "alice@bfh.ch",
          "electionTitle" => "Another ",
          "beginDate" => "2016-12-27 00:00:00",
          "endDate" => "2017-01-08 00:00:00",
          "appVersion" => "0.15",
          "coefficients" => "117727313401249309695199219537874356258369125963218823757206664043603872273945031493583242752212170784064201383058758337899359523722204326544389359267434867817426841712558693686737358892257581715740540187459604371701360271006305697147772236361284650014305862212834230126358776282609860359354460434856983431767315655046589980021062428303985793614745566801717044635948148648851995510489170883866366747800427167944279972452813010097954284185087780975284287066483930863132666435215039267602571827270075696159976598751866427896799123501746156435673428643425971755330596652450967025084948763627855175468824511257808781014667560227557197278510518393749936583695647352412225672359514323320721704095956195395909761315410598184479443293614515396946819006844826689913250168525663838886966189248086105058206126018375608637050677126996477747880427266744927257611397919623328382254475580178093254462266758107614780582064721354857273676532512295928285314050677218383252167673782398236248035304729893145479443700399560933101013594439348715617133044478282299479404978815993846582418320527819149743565038104992059375168165523261120214429998382149136086327800816261680892082168183713405402744650762772768814371227095340591359408111007221848012071098808",
          "electionGenerator" => "21806041978564351571474503545742705796371838434859211404645842299350887457561402506709098391742345475454641354631128164548088431359982207726350242392068016563282577092505766027976094628649575017854633586269602861293581203581143294622267380371884245774796516421347947469209775489575576103198859861085610364208",
          "votingTopic" => array(
            "topic" => "What",
            "pick" => 1,
            "options" => ["do", "You?"]
          ),
          "voters" => array(
            [
            "email" => "alice@bfh.ch",
            "signature" => "standInSignatur",
            "publicCredential" => "20675110888229975134537834262132428922107086374998449626153299194267801123774252949886446560645837323382925642338531169189172850547192678425943628272858081838679270943657517761598991043160399596186367379520096810174456607315917528528739226812909050942423504669796547776683297734229690101568360513250756518960",
            "appVersion" => "1.15"
            ]
          )
        );

    // Assert
    $this->assertEquals($jwsPayload, get_jwsPayload($jwsSignature));
    $this->assertNotEquals($temperedJwsPayload, get_jwsPayload($jwsSignature));
  }

}
